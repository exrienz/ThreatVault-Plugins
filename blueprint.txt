This guide explains how to send your security scan data (from tools like Nessus, OpenVAS, or CIS Benchmarks) into ThreatVault.
Itâ€™s written simply â€” even non-technical users can follow it.

Youâ€™ll learn:

The difference between VAPT and Compliance data

Which fields ThreatVault expects

How to map your toolâ€™s data

Example plugins you can use

ğŸ§© What Is a Plugin?
A plugin is a small Python module that transforms your uploaded scan file (usually CSV) into a format ThreatVault understands.

Workflow:

You upload a CSV/JSON scan file.

ThreatVault calls your pluginâ€™s process() function.

The plugin converts your data into the required schema.

ThreatVault validates the output and saves your findings.

ğŸ” Two Types of Data
Type
What It Does
Example
VAPT

Finds vulnerabilities (bugs, weak configurations)

â€œTLS 1.0 is enabledâ€

Compliance

Checks if rules or policies are followed

â€œPassword must be 8+ chars â€” âŒ FAILEDâ€

Quick rules:

VAPT: â€œWhatâ€™s broken?â€ â†’ Use risk (Critical, Highâ€¦)

Compliance: â€œDid we follow the rule?â€ â†’ Use status (PASSED, FAILED)

ğŸ§­ ThreatVault Field Requirements
1ï¸âƒ£ VAPT (Vulnerability Scan) Fields
Used for tools like Nessus, OpenVAS, Invicti:


Copy
{
  "cve": "CVE-2023-1234",      
  "risk": "High",              
  "host": "10.0.0.5",          
  "port": 443,                  
  "name": "TLS 1.0 Enabled",    
  "description": "TLS 1.0 is old and insecure...",  
  "remediation": "Upgrade to TLS 1.2 or higher",     
  "evidence": "Service: https", 
  "vpr_score": "8.2"            
}
âœ… Required: risk, host, port, name, description, remediation

ğŸ”¹ Optional: cve, evidence, vpr_score

2ï¸âƒ£ Compliance (Rule Check) Fields
Used for CIS, ISO 27001, and internal policy checks:


Copy
{
  "risk": "High",              
  "host": "webserver01",       
  "port": 0,                    
  "name": "Password Length â‰¥ 8",
  "description": "Must enforce 8+ characters",
  "remediation": "Set min length to 8",
  "evidence": "Current: 6",     
  "status": "FAILED"            
}
âœ… Required: risk, host, port, name, description, remediation, status

ğŸ”¹ Optional: evidence

Notes:

Nessus compliance scans donâ€™t use severity levels. risk values are mapped to status.

If risk is empty, the plugin assigns Medium automatically.

cve and vpr_score are not used for compliance scans.

ğŸ—ºï¸ Mapping Scan Data to ThreatVault
Source Field
â†’
ThreatVault Field
Notes
Risk

â†’

risk

Use Critical/High/Medium/Low. Leave empty for compliance â†’ auto Medium

Host

â†’

host

IP or hostname

Port

â†’

port

Use 0 if not applicable

Name

â†’

name

Issue title

Description

â†’

description

Full explanation

Solution

â†’

remediation

How to fix

Plugin Output / Actual Value

â†’

evidence

Proof from scan

VPR Score

â†’

vpr_score

Only for VAPT

(none)

â†’

status

Only for Compliance (copy from risk)

ğŸ§© Real Examples
ğŸ”¹ VAPT Scan (Nessus)
CSV Header:
CVE,Risk,Host,Port,Name,Description,Solution,Plugin Output,VPR Score

Mapped to ThreatVault JSON:


Copy
{
  "cve": "",
  "risk": "High",
  "host": "10.0.0.5",
  "port": 443,
  "name": "TLS 1.0 Enabled",
  "description": "Old protocol...",
  "remediation": "Upgrade TLS",
  "evidence": "Service: https",
  "vpr_score": "8.2"
}
ğŸ”¹ Compliance Scan (Nessus)
CSV Header:
CVE,Risk,Host,Port,Name,Description,Solution,Plugin Output,VPR Score

Mapped to ThreatVault JSON:


Copy
{
  "risk": "High",
  "host": "db01",
  "port": 0,
  "name": "Password Reuse Disabled",
  "description": "Must block reuse of last 5 passwords",
  "remediation": "Set to 5",
  "evidence": "Current: 0",
  "status": "FAILED"
}
âœ… Acceptable Values
Risk (Severity)

Value
Notes
CRITICAL

Only for VAPT

HIGH

Both

MEDIUM

Both

LOW

Both

None

Only Compliance â†’ auto Medium

Status

Scan Type
Allowed Values
VAPT

NEW, OPEN, CLOSED, EXEMPTION, OTHERS

Compliance

PASSED, FAILED, WARNING

ğŸ§° Plugin Examples
1ï¸âƒ£ Compliance Plugin (Python + Polars)

Copy
import polars as pl

def process(file: bytes, file_type: str) -> pl.LazyFrame:
    if file_type != "text/csv":
        raise ValueError(f"File type not supported: {file_type}")

    pattern2 = r"Actual Value:\s*\n(?s)(.*)"
    lf = pl.scan_csv(file)
    lf = (
        lf.with_columns(
            name=pl.col("Description").str.extract(r"^(.*): \[.*\]", 1),
            description=pl.col("Description")
                .str.extract(r"^(?:.*\n){2}((?s).*?)(?:^Actual Value:|$)", 1)
                .str.replace(pattern2, "")
                .str.replace_all("\n", "<br/>"),
            evidence=pl.col("Description")
                .str.extract(pattern2)
                .str.replace_all("\n", "<br/>")
                .str.strip_chars(),
            risk=pl.lit(None, dtype=pl.String),
        )
        .filter(pl.col("Risk") != "None", pl.col("Risk").is_not_null())
        .rename({"Solution": "remediation", "Risk": "status"})
        .drop(["VPR Score", "CVE", "Name", "Plugin Output", "Description"])
    )
    return lf
2ï¸âƒ£ VAPT Plugin (Python + Polars)

Copy
import polars as pl

def process(file: bytes, file_type: str) -> pl.LazyFrame:
    if file_type != "text/csv":
        raise ValueError(f"File type not supported: {file_type}")

    return (
        pl.scan_csv(file)
        .select(pl.all().name.map(lambda x: "_".join(x.lower().split(" "))))
        .filter(pl.col("risk") != "None")
        .with_columns(
            pl.col("solution", "description", "plugin_output").str.replace_all(
                "\n", " <br/> "
            )
        )
        .rename(
            {
                "solution": "remediation",
                "plugin_output": "evidence",
            }
        )
    )
ğŸš€ Quick Steps to Build Your Plugin
Decide: VAPT or Compliance

Read your CSV/JSON file

Rename columns to match ThreatVault

Fill in required fields

For Compliance (Nessus): status = risk

Remove unused fields (e.g., cve in Compliance)

Return Polars LazyFrame or DataFrame

Upload to ThreatVault â†’ Test â†’ Done

ğŸ Summary Table
Field
VAPT
Compliance
cve

âœ…

âŒ

risk

âœ…

âœ…

status

âŒ

âœ…

host

âœ…

âœ…

port

âœ…

âœ…

name

âœ…

âœ…

description

âœ…

âœ…

remediation

âœ…

âœ…

evidence

âœ…

âœ…

vpr_score

âœ…

âŒ
